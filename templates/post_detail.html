{% extends "base.html" %}
{% block title %}{{ post.title }} - chilaq{% endblock %}
{% block content %}
  <div class="row g-4">
    <div class="col-12 col-lg-8">
      <h2 class="mb-2">{{ post.title }}</h2>
      {% if post.artist and post.artist.name %}
        <div class="text-muted mb-3">
          <a href="/artist/{{ post.artist.slug or post.artist.id }}" class="text-decoration-none">{{ post.artist.name }}</a>
        </div>
      {% endif %}
      {% if embeds.youtube %}
        <div class="ratio ratio-16x9 mb-3">
          <iframe allowfullscreen src="{{ embeds.youtube }}"></iframe>
        </div>
      {% endif %}
      {% if embeds.spotify %}
        <div class="mb-3">
          <iframe style="width:100%;height:152px;border:0" allow="encrypted-media" src="{{ embeds.spotify }}"></iframe>
        </div>
      {% endif %}
      {% if embeds.apple %}
        <div class="mb-3">
          <iframe style="width:100%;height:{{ embeds.apple_h }}px;border:0;overflow:hidden;background:transparent;"
                  allow="autoplay *; encrypted-media *;"
                  src="{{ embeds.apple }}"></iframe>
        </div>
      {% endif %}
    </div>
    <div class="col-12 col-lg-4">
      {% if post.body %}
        <p class="mt-3">{{ post.body }}</p>
      {% endif %}

      <div class="mt-3 d-flex align-items-center gap-2">
        <button 
          class="like-btn like-btn-lg {% if request.cookies.get('liked_' ~ post.id|string) == '1' %}liked{% endif %}"
          type="button"
          data-like-btn="{{ post.id }}">
          <span class="heart">♥</span>
          <span class="count" data-like-count="{{ post.id }}">{{ post.likes or 0 }}</span>
        </button>
      </div>
      <div class="mt-3 d-flex align-items-center gap-2">
        <a href="http://twitter.com/share?url=https://www.chilaq.jp/p/{{post.slug}}&text=【{{post.title}} - {{post.artist.name}}】を発掘しました！" target="_blank">
          <button type="button" class="btn btn-dark">
            <span>Xでシェア</span>
          </button>
        </a>
      </div>
    </div>
  </div>
{% endblock %}
